# ============================================
# CONFIGURACIÓN - EMPRESA QA (RedSalud)
# ============================================
# Última actualización: 2025-11-15

# ============================================
# PROYECTO GCP
# ============================================
export GCP_PROJECT_ID="qa-ticket-home-redsalud"
export GCP_REGION="southamerica-west1"
export GCP_ZONE="southamerica-west1-a"

# ============================================
# APLICACIÓN
# ============================================
export APP_NAME="ticket-home"
export SERVICE_NAME="ticket-home"
export ENVIRONMENT="empresa-qa"

# ============================================
# DOMINIO Y DNS
# ============================================
export DOMAIN_NAME="qa-ticket-home.mhwdev.dev"

# ============================================
# CLOUD SQL
# ============================================
export CLOUDSQL_INSTANCE_NAME="qa-ticket-home"
export CLOUDSQL_INSTANCE_CONNECTION_NAME="${GCP_PROJECT_ID}:${GCP_REGION}:${CLOUDSQL_INSTANCE_NAME}"

# Base de Datos
export DB_NAME="qa_ticket_home"
export DB_USER="qa_user"
# DB_PASSWORD - No se incluye aquí por seguridad, está en Secret Manager

# ============================================
# SECRETS EN SECRET MANAGER
# ============================================
export SECRET_DATABASE_URL_NAME="tickethome-db-url"
export SECRET_KEY_NAME="tickethome-secret-key"
export SECRET_SUPERUSER_EMAILS_NAME="superuser-emails"

# Valores de superuser emails (para setup inicial)
export SUPERUSER_EMAILS="global_admin@tickethome.com;jonathan.segura@redsalud.cl;admin@tickethome.com"

# ============================================
# DOCKER & ARTIFACT REGISTRY
# ============================================
export ARTIFACT_REGISTRY_REGION="us-central1"
export ARTIFACT_REGISTRY_REPO="tickethome-repo"
export IMAGE_NAME="${ARTIFACT_REGISTRY_REGION}-docker.pkg.dev/${GCP_PROJECT_ID}/${ARTIFACT_REGISTRY_REPO}/${APP_NAME}"
export IMAGE_TAG="latest"

# ============================================
# SERVICE ACCOUNT
# ============================================
export SERVICE_ACCOUNT_NAME="qa-ticket-home"
export SERVICE_ACCOUNT_EMAIL="${SERVICE_ACCOUNT_NAME}@${GCP_PROJECT_ID}.iam.gserviceaccount.com"

# ============================================
# VPC CONNECTOR
# ============================================
export VPC_CONNECTOR="tckthome-conn-qa-sa-west1"
export VPC_EGRESS="private-ranges-only"

# ============================================
# CLOUD RUN - CONFIGURACIÓN
# ============================================
export CLOUD_RUN_MIN_INSTANCES="1"  # Siempre activo
export CLOUD_RUN_MAX_INSTANCES="3"
export CLOUD_RUN_MEMORY="1Gi"
export CLOUD_RUN_CPU="2"
export CLOUD_RUN_TIMEOUT="900"
export CLOUD_RUN_CONCURRENCY="80"
export CLOUD_RUN_PORT="8080"

# ============================================
# VARIABLES DE ENTORNO DE LA APLICACIÓN
# ============================================
export FLASK_ENV="production"
export FLASK_DEBUG="false"
export ENABLE_IAP="true"
export ENABLE_DEMO_LOGIN="false"  # ⚠️ Solo IAP/SSO en QA (sin login tradicional)
export RESET_DB_ON_STARTUP="false"

# ============================================
# GOOGLE GROUPS (IAP)
# ============================================
export IAP_ACCESS_GROUP="qa-ticket-home-rs@googlegroups.com"

# ============================================
# BUILD METHOD
# ============================================
export BUILD_METHOD="docker-desktop"  # Empresa requiere Docker Desktop local

# ============================================
# NOTAS
# ============================================
# - Ambiente de pre-producción de RedSalud
# - Min instances = 1 (siempre activo)
# - Usa VPC Connector para conectar a Cloud SQL (más seguro)
# - ⚠️ Solo SSO/IAP (sin login tradicional) - Más cercano a producción
# - Grupo Google separado de DEV
# - Región southamerica-west1 (Chile)
# - Build DEBE ser con Docker Desktop (política empresa)
